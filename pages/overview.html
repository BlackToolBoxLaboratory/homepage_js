<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-cache" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" type="text/css" href="../libs/fontawesome/css/all.min.css">
  <link rel="stylesheet" type="text/css" href="../libs/apexcharts/apexcharts.css">
  <link rel="stylesheet" type="text/css" href="../style/index.css">
  <link rel="stylesheet" type="text/css" href="../style/pages/overview.css">

  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <title>BTB Lab. | JavaScript | Languages </title>
  <meta name="google-site-verification" content="XjkUm8M885lvmNSs9BKe9khMCQY99rSfGsN3Tf6yfBY" />

  <meta property="og:title" content="Black Tool Box Laboratory | JavaScript | About" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://blacktoolboxlaboratory.github.io/javascript" />
  <meta property="og:image" content="" />
  <meta name="description" property="og:description" content="
    Here are some components developed with pure JavaScript and made by Black Tool Box Laboratory." />

  <meta property="fb:app_id" content="271733690121245" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@vannoel0628" />
  <meta name="twitter:creator" content="@vannoel0628" />
</head>

<body id="language" class="page">
  <div class="page_container">
    <div class="page_head">
      <h1 class="page_title" btb-lang="route.overview">Overview</h1>
      <a class="head_linkBtn linkBtn-github" href="https://github.com/BlackToolBoxLaboratory?q=prototype"
        target="_blank">
        <i class="fab fa-github fa-fw"></i>
      </a>
      <a class="head_linkBtn linkBtn-npm" href="https://www.npmjs.com/search?q=%40blacktoolbox%2Fprototype"
        target="_blank">
        <i class="fab fa-npm fa-fw"></i>
      </a>
    </div>
    <section class="page_section">
      <div class="section_title">
        JAVASCRIPT
      </div>
      <div id="jsList" class="grid-row"></div>
    </section>
    <section class="page_section">
      <div class="section_title">
        REACT
      </div>
      <div id="reactList" class="grid-row"></div>
    </section>
    <section class="page_section">
      <div class="section_title">
        VUE
      </div>
      <div id="vueList" class="grid-row"></div>
    </section>
  </div>

  <script type="text/javascript" src="../libs/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="../libs/apexcharts/apexcharts.min.js"></script>
  <script type="text/javascript" src="../libs/axios/axios.min.js"></script>
  <script type="text/javascript" src="../utils/reviseISOString.js"></script>
  <script type="text/javascript" src="../utils/createDownloadChartOptions.js"></script>
  <script>
    var WEEK = 7;

    function translateAll() {
      $('[btb-lang]').each(function (index, entry) {
        $(entry).html(top.envLang.translate(entry.getAttribute('btb-lang')))
      })
    }

    function _extractToWeekly(data) {
      data.reverse();
      let weekData = Array(Math.ceil(data.length / WEEK))
        .fill(0)
        .map((entry, index) => {
          let count = 0;
          for (let i = index * WEEK; i < Math.min((index + 1) * WEEK, data.length); i++) {
            count += data[i].downloads;
          }
          return count;
        });
      return weekData.reverse();
    }

    function getPackages(type) {
      let paramText = '@blacktoolbox';
      switch (type) {
        case 'js':
          paramText += '/prototype-';
          break;
        case 'react':
          paramText += '/react-';
          break;
        case 'vue':
          paramText += '/vue-';
          break;
      }
      const instance = axios.create({
        baseURL: 'https://registry.npmjs.org/',
        timeout: 1000,
      });
      instance.get('-/v1/search', {
        params: {
          text: paramText,
        },
      }).then(function (response) {
        renderPackages(type, response.data.objects);
      })
    }
    function getDownload(type, packageName) {
      const instance = axios.create({
        baseURL: 'https://api.npmjs.org/',
        timeout: 1000,
      });
      instance.get('/downloads/range/last-year/' + packageName).then(function (response) {
        if (response.data.downloads.length) {
          renderDownload(type, packageName, _extractToWeekly(response.data.downloads));
        }
      })
    }
    function renderPackages(type, data) {
      var render = '';
      data.forEach(function (item) {
        var package = item.package;
        render += ('<div class="grid-col col-lg-6">');
        render += ('<div class="overview-package-widget">');

        render += ('<p class="widget_title">');
        render += (package.name + '<a class="inline-link" href="https://www.npmjs.com/package/' + package.name + '" target="_blank" rel="noreferrer" >');
        render += ('<i class="fas fa-external-link-alt fa-fw fa-xs"></i>');
        render += ('</a>')

        render += ('<p class="widget_description">' + package.description + '</p>');

        render += ('<p>');
        render += ('<span class="widget_entry" btb-lang="overview.version_colon">Version:</span>');
        render += ('<span class="widget_value">' + package.version + '</span>');
        render += ('</p>');

        render += ('<p>');
        render += ('<span class="widget_entry" btb-lang="overview.release_colon">Release Date:</span>');
        render += ('<span class="widget_value">' + reviseISOString(package.date).date + '</span>');
        render += ('</p>');

        render += ('<div id="downloads_' + package.name.replace('@blacktoolbox/', '') + '"></div>');

        render += ('</p>');
        render += ('</div>');
        render += ('</div>');
      });

      $('#' + type + 'List').html(render);

      data.forEach(function (item) {
        getDownload(type, item.package.name);
      })
    }

    function renderDownload(type, packageName, data) {
      var render = '';
      render += ('<p>');
      render += ('<span class="widget_entry" btb-lang="overview.download_colon">Latest Downloads:</span>');
      render += ('<span class="widget_value">' + data[data.length - 1] + '</span>');
      render += ('</p>');

      render += ('<div class="widget_chart">');
      render += ('<p class="widget_row">');
      render += ('<span class="widget_entry" btb-lang="overview.downloads_colon">Weekly Downloads:</span>');
      render += ('</p>');
      render += ('<div id="chart_' + packageName.replace('@blacktoolbox/', '') + '"></div>');
      render += ('</div>');

      $('#downloads_' + packageName.replace('@blacktoolbox/', '')).html(render);

      renderChart(type, packageName, data);
    }

    function renderChart(type, packageName, data) {
      var options = createDownloadChartOptions(type);
      options.series = [{
        data
      }];
      options.chart.type = "area";
      options.chart.height = "100%";

      var chart = new ApexCharts(document.querySelector('#chart_' + packageName.replace('@blacktoolbox/', '')), options);
      chart.render();
    }

    function redirectHash(path) {
      top.location.hash = "#/" + path;
    }

    $(document).ready(function () {
      translateAll();

      getPackages('js');
      getPackages('react');
      getPackages('vue');
    });
  </script>
</body>

</html>